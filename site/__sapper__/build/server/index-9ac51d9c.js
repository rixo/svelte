'use strict';

var index = require('./index-cfd1953e.js');

/* src/routes/apps/index.svelte generated by Svelte v3.12.0 */

const css = {
	code: ".apps.svelte-1a795bd{padding:var(--top-offset) var(--side-nav) 6rem var(--side-nav);max-width:var(--main-width);margin:0 auto}header.svelte-1a795bd{margin:0 0 1em 0}h1.svelte-1a795bd{font-size:4rem;font-weight:400}.user.svelte-1a795bd{display:flex;padding:0 0 0 3.2rem;position:relative;margin:1rem 0 5rem 0;color:var(--text)}.avatar.svelte-1a795bd{position:absolute;left:0;top:0.1rem;width:2.4rem;height:2.4rem;border:1px solid rgba(0,0,0,0.3);border-radius:0.2rem}ul.svelte-1a795bd{list-style:none}li.svelte-1a795bd{margin:0 0 1em 0}h2.svelte-1a795bd{color:var(--text);font-size:var(--h3);font-weight:400}li.svelte-1a795bd a.svelte-1a795bd{border:none}li.svelte-1a795bd a:hover h2.svelte-1a795bd{color:var(--flash)}li.svelte-1a795bd span.svelte-1a795bd{font-size:14px;color:#999}",
	map: "{\"version\":3,\"file\":\"index.svelte\",\"sources\":[\"index.svelte\"],\"sourcesContent\":[\"<script context=\\\"module\\\">\\n\\texport async function preload(page, { user }) {\\n\\t\\tlet apps = [];\\n\\t\\tlet offset = null;\\n\\n\\t\\tif (user) {\\n\\t\\t\\tlet url = 'apps.json';\\n\\t\\t\\tif (page.query.offset) {\\n\\t\\t\\t\\turl += `?offset=${encodeURIComponent(page.query.offset)}`;\\n\\t\\t\\t}\\n\\t\\t\\tconst r = await this.fetch(url, {\\n\\t\\t\\t\\tcredentials: 'include'\\n\\t\\t\\t});\\n\\t\\t\\tif (!r.ok) return this.error(r.status, await r.text());\\n\\n\\t\\t\\t({ apps, offset } = await r.json());\\n\\t\\t}\\n\\n\\t\\treturn { user, apps, offset };\\n\\t}\\n</script>\\n\\n<script>\\n\\timport { getContext } from 'svelte';\\n\\n\\texport let user;\\n\\texport let apps;\\n\\texport let offset;\\n\\n\\tconst { login, logout } = getContext('app');\\n\\n\\tconst formatter = new Intl.DateTimeFormat(undefined, {\\n\\t\\tyear: 'numeric',\\n\\t\\tmonth: 'short',\\n\\t\\tday: 'numeric',\\n\\t\\thour: 'numeric',\\n\\t\\tminute: '2-digit'\\n\\t});\\n\\n\\tconst format = str => formatter.format(new Date(str));\\n</script>\\n\\n<svelte:head>\\n\\t<title>Your apps • Svelte</title>\\n</svelte:head>\\n\\n<div class=\\\"apps\\\">\\n\\t{#if user}\\n\\t\\t<header>\\n\\t\\t\\t<h1>Your apps</h1>\\n\\n\\t\\t\\t<div class=\\\"user\\\">\\n\\t\\t\\t\\t<img class=\\\"avatar\\\" alt=\\\"{user.name || user.username} avatar\\\" src=\\\"{user.avatar}\\\">\\n\\t\\t\\t\\t<span>\\n\\t\\t\\t\\t\\t{user.name || user.username}\\n\\t\\t\\t\\t\\t(<a on:click|preventDefault={logout} href=\\\"auth/logout\\\">log out</a>)\\n\\t\\t\\t\\t</span>\\n\\t\\t\\t</div>\\n\\t\\t</header>\\n\\n\\t\\t<ul>\\n\\t\\t\\t{#each apps as app}\\n\\t\\t\\t\\t<li>\\n\\t\\t\\t\\t\\t<a href=\\\"repl/{app.uid}\\\">\\n\\t\\t\\t\\t\\t\\t<h2>{app.name}</h2>\\n\\t\\t\\t\\t\\t\\t<span>updated {format(app.updated_at)}</span>\\n\\t\\t\\t\\t\\t</a>\\n\\t\\t\\t\\t</li>\\n\\t\\t\\t{/each}\\n\\t\\t</ul>\\n\\n\\t\\t{#if offset !== null}\\n\\t\\t\\t<div><a href=\\\"apps?offset={offset}\\\">Next page...</a></div>\\n\\t\\t{/if}\\n\\t{:else}\\n\\t\\t<p>Please <a on:click|preventDefault={login} href=\\\"auth/login\\\">log in</a> to see your saved apps.</p>\\n\\t{/if}\\n</div>\\n\\n<style>\\n\\t.apps {\\n\\t\\tpadding: var(--top-offset) var(--side-nav) 6rem var(--side-nav);\\n\\t\\tmax-width: var(--main-width);\\n\\t\\tmargin: 0 auto;\\n\\t}\\n\\n\\theader {\\n\\t\\tmargin: 0 0 1em 0;\\n\\t}\\n\\n\\th1 {\\n\\t\\tfont-size: 4rem;\\n\\t\\tfont-weight: 400;\\n\\t}\\n\\n\\t.user {\\n\\t\\tdisplay: flex;\\n\\t\\tpadding: 0 0 0 3.2rem;\\n\\t\\tposition: relative;\\n\\t\\tmargin: 1rem 0 5rem 0;\\n\\t\\tcolor: var(--text);\\n\\t}\\n\\n\\t.avatar {\\n\\t\\tposition: absolute;\\n\\t\\tleft: 0;\\n\\t\\ttop: 0.1rem;\\n\\t\\twidth: 2.4rem;\\n\\t\\theight: 2.4rem;\\n\\t\\tborder: 1px solid rgba(0,0,0,0.3);\\n\\t\\tborder-radius: 0.2rem;\\n\\t}\\n\\n\\tul {\\n\\t\\tlist-style: none;\\n\\t}\\n\\n\\tli {\\n\\t\\tmargin: 0 0 1em 0;\\n\\t}\\n\\n\\th2 {\\n\\t\\tcolor: var(--text);\\n\\t\\tfont-size: var(--h3);\\n\\t\\tfont-weight: 400;\\n\\t}\\n\\n\\tli a {\\n\\t\\tborder: none;\\n\\t}\\n\\n\\tli a:hover h2 {\\n\\t\\tcolor: var(--flash);\\n\\t}\\n\\n\\tli span {\\n\\t\\tfont-size: 14px;\\n\\t\\tcolor: #999;\\n\\t}\\n</style>\\n\"],\"names\":[],\"mappings\":\"AAgFC,KAAK,eAAC,CAAC,AACN,OAAO,CAAE,IAAI,YAAY,CAAC,CAAC,IAAI,UAAU,CAAC,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,CAC/D,SAAS,CAAE,IAAI,YAAY,CAAC,CAC5B,MAAM,CAAE,CAAC,CAAC,IAAI,AACf,CAAC,AAED,MAAM,eAAC,CAAC,AACP,MAAM,CAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,AAClB,CAAC,AAED,EAAE,eAAC,CAAC,AACH,SAAS,CAAE,IAAI,CACf,WAAW,CAAE,GAAG,AACjB,CAAC,AAED,KAAK,eAAC,CAAC,AACN,OAAO,CAAE,IAAI,CACb,OAAO,CAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CACrB,QAAQ,CAAE,QAAQ,CAClB,MAAM,CAAE,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CACrB,KAAK,CAAE,IAAI,MAAM,CAAC,AACnB,CAAC,AAED,OAAO,eAAC,CAAC,AACR,QAAQ,CAAE,QAAQ,CAClB,IAAI,CAAE,CAAC,CACP,GAAG,CAAE,MAAM,CACX,KAAK,CAAE,MAAM,CACb,MAAM,CAAE,MAAM,CACd,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CACjC,aAAa,CAAE,MAAM,AACtB,CAAC,AAED,EAAE,eAAC,CAAC,AACH,UAAU,CAAE,IAAI,AACjB,CAAC,AAED,EAAE,eAAC,CAAC,AACH,MAAM,CAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,AAClB,CAAC,AAED,EAAE,eAAC,CAAC,AACH,KAAK,CAAE,IAAI,MAAM,CAAC,CAClB,SAAS,CAAE,IAAI,IAAI,CAAC,CACpB,WAAW,CAAE,GAAG,AACjB,CAAC,AAED,iBAAE,CAAC,CAAC,eAAC,CAAC,AACL,MAAM,CAAE,IAAI,AACb,CAAC,AAED,iBAAE,CAAC,CAAC,MAAM,CAAC,EAAE,eAAC,CAAC,AACd,KAAK,CAAE,IAAI,OAAO,CAAC,AACpB,CAAC,AAED,iBAAE,CAAC,IAAI,eAAC,CAAC,AACR,SAAS,CAAE,IAAI,CACf,KAAK,CAAE,IAAI,AACZ,CAAC\"}"
};

async function preload(page, { user }) {
	let apps = [];
	let offset = null;

	if (user) {
		let url = 'apps.json';
		if (page.query.offset) {
			url += `?offset=${encodeURIComponent(page.query.offset)}`;
		}
		const r = await this.fetch(url, {
			credentials: 'include'
		});
		if (!r.ok) return this.error(r.status, await r.text());

		({ apps, offset } = await r.json());
	}

	return { user, apps, offset };
}

const Index = index.create_ssr_component(($$result, $$props, $$bindings, $$slots) => {
	let { user, apps, offset } = $$props;

	const { login, logout } = index.getContext('app');

	const formatter = new Intl.DateTimeFormat(undefined, {
		year: 'numeric',
		month: 'short',
		day: 'numeric',
		hour: 'numeric',
		minute: '2-digit'
	});

	const format = str => formatter.format(new Date(str));

	if ($$props.user === void 0 && $$bindings.user && user !== void 0) $$bindings.user(user);
	if ($$props.apps === void 0 && $$bindings.apps && apps !== void 0) $$bindings.apps(apps);
	if ($$props.offset === void 0 && $$bindings.offset && offset !== void 0) $$bindings.offset(offset);

	$$result.css.add(css);

	return `${($$result.head += `<title>Your apps • Svelte</title>`, "")}

	<div class="apps svelte-1a795bd">
		${ user ? `<header class="svelte-1a795bd">
				<h1 class="svelte-1a795bd">Your apps</h1>

				<div class="user svelte-1a795bd">
					<img class="avatar svelte-1a795bd" alt="${index.escape(user.name || user.username)} avatar"${index.add_attribute("src", user.avatar, 0)}>
					<span>
						${index.escape(user.name || user.username)}
						(<a href="auth/logout">log out</a>)
					</span>
				</div>
			</header>

			<ul class="svelte-1a795bd">
				${index.each(apps, (app) => `<li class="svelte-1a795bd">
						<a href="repl/${index.escape(app.uid)}" class="svelte-1a795bd">
							<h2 class="svelte-1a795bd">${index.escape(app.name)}</h2>
							<span class="svelte-1a795bd">updated ${index.escape(format(app.updated_at))}</span>
						</a>
					</li>`)}
			</ul>

			${ offset !== null ? `<div><a href="apps?offset=${index.escape(offset)}">Next page...</a></div>` : `` }` : `<p>Please <a href="auth/login">log in</a> to see your saved apps.</p>` }
	</div>`;
});

exports.default = Index;
exports.preload = preload;
